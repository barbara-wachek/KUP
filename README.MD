# ğŸ“š KUP â€“ Eksport i archiwizacja rekordÃ³w PBL

Skrypt w Pythonie do pobierania rekordÃ³w z bazy Oracle, filtrowania ich na podstawie uÅ¼ytkownika i dat, dzielenia na mniejsze paczki oraz automatycznego zapisywania w plikach `.ods` i przesyÅ‚ania na **Google Drive**.  
Dodatkowo skrypt aktualizuje arkusz Google Sheets, aby zachowaÄ‡ historiÄ™ wszystkich juÅ¼ przetworzonych rekordÃ³w.  
Na koniec wygenerowane pliki naleÅ¼y przesÅ‚aÄ‡ mailowo do odpowiedniego pracownika zgodnie z ustalonymi zasadami.

---

## âš™ï¸ FunkcjonalnoÅ›ci

- Pobiera dane z bazy Oracle (poÅ‚Ä…czenie przez `cx_Oracle`).
- Filtruje rekordy wedÅ‚ug uÅ¼ytkownika i daty.
- Sprawdza, ktÃ³re rekordy zostaÅ‚y juÅ¼ wczeÅ›niej zapisane (na podstawie Google Sheets).
- Dzieli dane na mniejsze pliki `.ods` (200â€“220 wierszy kaÅ¼dy).
- Zapisuje pliki lokalnie w folderze `data/`.
- WysyÅ‚a pliki do wybranego folderu na Google Drive.
- Aktualizuje arkusz Google Sheets z listÄ… przetworzonych ID.


## ğŸ› ï¸ Wymagania

- ğŸ Python 3.10+
- ğŸ“¦ Zainstalowane paczki: cx_Oracle, pandas, PyDrive, gspread, gspread_dataframe
- ğŸ”‘ Konto Google z dostÄ™pem do Google Drive, w ktÃ³rym bÄ™dÄ… zapisywane pliki
- ğŸ“„ Plik `client_secrets.json` w katalogu z kodem (plik z danymi uwierzytelniajÄ…cymi OAuth 2.0 dla Google Drive).
  - MoÅ¼na go pobraÄ‡ z [Google Cloud Console](https://console.cloud.google.com/apis/credentials)
  - Musi byÄ‡ poprawnie skonfigurowany, aby skrypt mÃ³gÅ‚ przesyÅ‚aÄ‡ pliki na Google Drive

## ğŸ”„ Workflow (dziaÅ‚ania uÅ¼ytkownika)

1. OtwÃ³rz terminal (cmd) w folderze z kodem.  
2. Uruchom skrypt poleceniem:
   ``` bash
   python KUP.py
   ```

3. Wpisz nazwÄ™ uÅ¼ytkownika, gdy pojawi siÄ™ komunikat.
4. Skrypt automatycznie pobierze dane, podzieli je na pliki `.ods` i wyÅ›le je na Google Drive i lokalnego folderu `data/`.
5. Wygenerowane pliki naleÅ¼y nastÄ™pnie wysÅ‚aÄ‡ mailowo do odpowiedniego pracownika.

---
